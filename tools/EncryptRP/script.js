const crypto=require("crypto"),algorithm="aes-256-cfb8",letters="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890";function randomString(e){let t="";for(let n=0;n<e;n++)t+=letters.charAt(Math.floor(Math.random()*letters.length));return t}function generateKey(){let e=randomString(32),t=e.slice(0,16);return{key:e,iv:t}}function encryptContent(e,t,n){let a=new Uint8Array(e),r=crypto.createCipheriv(algorithm,t,n),l=r.update(a);return l}function decryptContent(e,t,n){let a=crypto.createDecipheriv(algorithm,t,n),r=a.update(e);return r}async function encryptFile(){let e=document.getElementById("encryptFileInput"),t=document.getElementById("encryptKeyInput"),n=e.files[0],a=t.value,r=n.name;if(a&&!/^[a-zA-Z0-9]{32}$/.test(a)){alert("Encryption key must be 32 characters long and contain only alphanumeric characters.");return}if(!n){alert("No file selected!");return}try{let l=await n.arrayBuffer(),c=new JSZip,s=new JSZip;await c.loadAsync(l);let o,d,y=[];for(let f in c.files)if(f.endsWith("manifest.json")){o=f.slice(0,f.lastIndexOf("manifest.json"));let p=c.files[f],u=await p.async("text"),h=JSON.parse(u);d=h.header.uuid}if(!d)throw Error("manifest.json not found!");for(let g in c.files){let $=c.files[g];if($.dir)s.folder(g);else if(g.endsWith("manifest.json")||g.endsWith("pack_icon.png")||g.endsWith("bug_pack_icon.png")){let m=await $.async("arraybuffer");s.file(g,m)}else{let w=await $.async("arraybuffer"),{key:v,iv:x}=generateKey(),b=encryptContent(w,v,x);s.file(g,b),y.push({path:g.slice(o.length),key:v})}}let E=new TextEncoder().encode(JSON.stringify({content:y})).buffer,{key:I,iv:C}=generateKey();I&&(C=I.slice(0,16));let B=new Uint8Array([0,0,0,0]),k=new Uint8Array([252,185,207,155]),j=new Uint8Array(8),W=new Uint8Array([36]),_=new TextEncoder("utf-8").encode(d),L=new Uint8Array(203),R=encryptContent(E,I,C),F=new Uint8Array([...B,...k,...j,...W,..._,...L,...R]);s.file(o+"contents.json",F),await s.generateAsync({type:"blob"}).then(function(e){document.getElementById("key").textContent="Encryption Key: "+I;let t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=`encrypted_${r}`,document.body.appendChild(n),n.click(),document.body.removeChild(n)}),alert("Encryption complete!")}catch(P){console.error("Error encrypting file:",P),alert("Error encrypting file...")}}async function decryptFile(){let e=document.getElementById("decryptFileInput"),t=document.getElementById("decryptKeyInput"),n=e.files[0];console.log(n);let a=t.value;if(!/^[a-zA-Z0-9]{32}$/.test(a)){alert("Encryption key must be 32 characters long and contain only alphanumeric characters.");return}if(!n){alert("No file selected!");return}try{let r=await n.arrayBuffer(),l=new JSZip,c=new JSZip;await l.loadAsync(r);let s,o=new Map,d=new Map;for(let y in l.files)if(y.endsWith("contents.json")){s=y.slice(0,y.lastIndexOf("contents.json"));let f=l.files[y],p=await f.async("arraybuffer");var u=new DataView(p),h=p.byteLength-256,g=new Uint8Array(u.buffer,256,h);let $=decryptContent(g,a,a.slice(0,16)),m=JSON.parse(String.fromCharCode.apply("",new Uint16Array($)));m.content.forEach(e=>{e.key&&(o.set(e.path,e.key),d.set(e.path,e.key.slice(0,16)))})}for(let w in l.files){let v=l.files[w];if(v.dir)c.folder(w);else if(w.endsWith("manifest.json")||w.endsWith("pack_icon.png")||w.endsWith("bug_pack_icon.png")||w.endsWith("contents.json")){if(w.endsWith("contents.json"))continue;let x=await v.async("arraybuffer");c.file(w,x)}else{let b=await v.async("arraybuffer"),E=o.get(w.slice(s.length)),I=d.get(w.slice(s.length)),C=decryptContent(b,E,I);c.file(w,C)}}await c.generateAsync({type:"blob"}).then(function(e){let t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=`decrypted_${name}`,document.body.appendChild(n),n.click(),document.body.removeChild(n)}),alert("Decryption complete!")}catch(B){console.error("Error decrypting file:",B),alert("Error decrypting file...")}}document.addEventListener("DOMContentLoaded",function(){document.getElementById("encryptFileInput").addEventListener("change",function(){let e=this.value.split("\\").pop();if(this.value.split("\\").pop().length>7&&(e=this.value.split("\\").pop().slice(0,7)+"..."),this.value){let t=document.getElementById("encryptButton");t.disabled=!1}else e="Select a file";document.getElementById("encryptLabel").innerText=e}),document.getElementById("decryptFileInput").addEventListener("change",function(){let e=this.value.split("\\").pop();if(this.value.split("\\").pop().length>7&&(e=this.value.split("\\").pop().slice(0,7)+"..."),this.value){let t=document.getElementById("decryptButton");t.disabled=!1}else e="Select a file";document.getElementById("decryptLabel").innerText=e})});const canvas=document.getElementById("backgroundCanvas"),ctx=canvas.getContext("2d");canvas.width=window.innerWidth,canvas.height=window.innerHeight;const polygons=[];function getRandom(e,t){return Math.random()*(t-e)+e}function createPolygon(){let e=Math.floor(getRandom(3,8)),t=getRandom(0,canvas.width),n=getRandom(0,canvas.height),a=getRandom(20,100),r=getRandom(0,360),l=getRandom(.1,.5);return{x:t,y:n,radius:a,sides:e,color:"#ffffff03",angle:r,speed:l}}function drawPolygon(e){ctx.beginPath(),ctx.moveTo(e.x+e.radius*Math.cos(e.angle),e.y+e.radius*Math.sin(e.angle));for(let t=1;t<=e.sides;t++)ctx.lineTo(e.x+e.radius*Math.cos(e.angle+2*t*Math.PI/e.sides),e.y+e.radius*Math.sin(e.angle+2*t*Math.PI/e.sides));ctx.closePath(),ctx.fillStyle=e.color,ctx.fill()}function update(){ctx.clearRect(0,0,canvas.width,canvas.height),polygons.forEach(e=>{e.x+=e.speed*Math.cos(e.angle),e.y+=e.speed*Math.sin(e.angle),e.x>canvas.width+e.radius&&(e.x=-e.radius),e.y>canvas.height+e.radius&&(e.y=-e.radius),e.x<-e.radius&&(e.x=canvas.width+e.radius),e.y<-e.radius&&(e.y=canvas.height+e.radius),e.angle+=.01*e.speed,e.angle>360&&(e.angle-=360),drawPolygon(e)}),requestAnimationFrame(update)}for(let i=0;i<30;i++)polygons.push(createPolygon());update(),window.addEventListener("resize",()=>{canvas.width=window.innerWidth,canvas.height=window.innerHeight});